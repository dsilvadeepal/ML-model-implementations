setwd("C:/Users/dsilv/Desktop/Learning/Data Science/ML-model-implementations/Logistic Regression")
library(tidyverse) # metapackage with lots of helpful functions
library(caTools)
library(ROCR)
framingham = read.csv("framingham.csv")
str(framingham)
summary(framingham)
set.seed(500)
split = sample.split(framingham$TenYearCHD, SplitRatio = 0.70)
train = subset(framingham, split==TRUE)
test = subset(framingham, split==FALSE)
framinghamLog = glm(TenYearCHD ~ ., data = train, family=binomial)
summary(framinghamLog)
predictTest = predict(framinghamLog, type="response", newdata=test)
table(test$TenYearCHD, predictTest > 0.5)
(926 + 18)/(926 + 13 + 145 + 18)
ROCRpred = prediction(predictTest, test$TenYearCHD)
as.numeric(performance(ROCRpred, "auc")@y.values)
framinghamLog = glm(TenYearCHD ~   .-education-BMI-diaBP-BPMeds-diabetes-prevalentStroke-heartRate-currentSmoker, data = train, family=binomial)
summary(framinghamLog)
predictTest = predict(framinghamLog, type="response", newdata=test)
table(test$TenYearCHD, predictTest > 0.5)
(969 + 19) / (969 + 9 + 156 +19)
ROCRpred = prediction(predictTest, test$TenYearCHD)
as.numeric(performance(ROCRpred, "auc")@y.values)
